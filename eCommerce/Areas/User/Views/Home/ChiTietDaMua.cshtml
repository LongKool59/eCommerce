@model eCommerce.Areas.User.Models.ViewModel
@{
    ViewBag.Title = "Chi tiết đã mua";
    Layout = "~/Areas/User/Views/Shared/_LayoutUser.cshtml";
}
@using eCommerce.Models;
<div>
    <h4>DauGiaViewModel</h4>
    <hr />
    <div>

        <dl class="dl-horizontal">
            <dt>
                @Html.DisplayNameFor(model => model.DauGia.MaDauGia)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.DauGia.MaDauGia)
            </dd>

            <dt>
                @Html.DisplayNameFor(model => model.DauGia.MaNguoiBan)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.DauGia.MaNguoiBan)
            </dd>



            <dt>
                @Html.DisplayNameFor(model => model.DauGia.TenSanPham)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.DauGia.TenSanPham)
            </dd>

            <dt>
                @Html.DisplayNameFor(model => model.DauGia.MoTa)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.DauGia.MoTa)
            </dd>

            <dt>
                @Html.DisplayNameFor(model => model.DauGia.GiaBanDau)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.DauGia.GiaBanDau)
            </dd>

            <dt>
                @Html.DisplayNameFor(model => model.DauGia.MucNangToiThieu)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.DauGia.MucNangToiThieu)
            </dd>


            <dt>
                @Html.DisplayNameFor(model => model.DauGia.NgayBatDau)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.DauGia.NgayBatDau)
            </dd>

            <dt>
                @Html.DisplayNameFor(model => model.DauGia.NgayKetThuc)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.DauGia.NgayKetThuc)
            </dd>


        </dl>
        @foreach (var item in Model.ListLoaiSanPham)
        {
            @Html.DisplayFor(model => item.TenLoai)
            <p></p>
        }
        @foreach (var item in Model.Hinh)
        {
            <img src=@item />
        }
    </div>
    @{
        DauGiaEntities db = new DauGiaEntities();
        var tt = db.CT_TrangThai.Where(m => m.MaDauGia == Model.DauGia.MaDauGia).OrderByDescending(s => s.ThoiGian).First();
        var ten = db.TrangThaiDauGias.Where(m => m.MaTrangThai == tt.MaTrangThai).SingleOrDefault();
        if (Model.DauGia.NgayThanhToan == null)
        {
            @Html.ActionLink("Thanh Toán", "ThanhToan", new { id = Model.DauGia.MaDauGia })

        }
        else if (ten.TenTrangThai != "Done")
        {
            using (Html.BeginForm("XacNhan", "Home", FormMethod.Post))
            {
                <input name="submit" hidden="true" value="@Model.DauGia.MaDauGia" />

                <input type="submit" value="Xác nhận đã nhận hàng" onclick="return confirm('Bạn chắc chắn muốn thanh toán')" />
            }
        }
        else
        {
            <p>Đơn hàng hoàn tất</p>
        }
    }

</div>
<p>
    @Html.ActionLink("Back to List", "Index")
</p>
